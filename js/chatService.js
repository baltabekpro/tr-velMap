/**
 * ========================================
 * –ß–ê–¢–ë–û–¢ –ú–ò–ö–†–û–°–ï–†–í–ò–°–Ü / CHATBOT SERVICE
 * ========================================
 * –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—Ç—ñ —á–∞—Ç–±–æ—Ç - “õ–∞–∑–∞“õ –∂”ô–Ω–µ –æ—Ä—ã—Å —Ç—ñ–ª–¥–µ—Ä—ñ–Ω–¥–µ
 */

// –ß–∞—Ç–±–æ—Ç –∂–∞—É–∞–ø—Ç–∞—Ä—ã–Ω—ã“£ –±–∞–∑–∞—Å—ã (“ö–∞–∑–∞“õ –∂”ô–Ω–µ –û—Ä—ã—Å —Ç—ñ–ª–¥–µ—Ä—ñ–Ω–¥–µ)
const chatbotResponses = {
    // –°”ô–ª–µ–º–¥–µ—Å—É–ª–µ—Ä
    greeting: [
        "–°”ô–ª–µ–º! <i class='fa-solid fa-hand-wave'></i> –ú–µ–Ω —Å—ñ–∑–¥—ñ“£ –≤–∏—Ä—Ç—É–∞–ª–¥—ã –≥–∏–¥—ñ“£—ñ–∑–±—ñ–Ω. –ê–ª–º–∞—Ç—ã —Ç—É—Ä–∞–ª—ã –Ω–µ –±—ñ–ª–≥—ñ“£—ñ–∑ –∫–µ–ª–µ–¥—ñ?",
        "“ö–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑! <i class='fa-solid fa-sparkles'></i> –ê–ª–º–∞—Ç—ã–Ω—ã“£ –¥–µ–º–∞–ª—ã—Å –æ—Ä—ã–Ω–¥–∞—Ä—ã —Ç—É—Ä–∞–ª—ã —Å“±—Ä–∞—Å—Ç—ã—Ä—ã“£—ã–∑!",
        "–ü—Ä–∏–≤–µ—Ç! <i class='fa-solid fa-hand-wave'></i> –Ø –≤–∞—à –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –≥–∏–¥. –ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –æ–± –ê–ª–º–∞—Ç—ã?"
    ],
    
    // –ú–µ–¥–µ—É –∂–∞–π—ã–Ω–¥–∞
    medeu: [
        "<i class='fa-solid fa-mountain-sun'></i> –ú–µ–¥–µ—É - ”ô–ª–µ–º–¥–µ–≥—ñ –µ“£ –±–∏—ñ–∫ –º“±–∑ –∞–π–¥—ã–Ω—ã! –¢–∞–º–∞—à–∞ –∫”©—Ä—ñ–Ω—ñ—Å –∂”ô–Ω–µ —Ç–∞–∑–∞ –∞—É–∞. ‚Ññ6 –∞–≤—Ç–æ–±—É—Å–ø–µ–Ω –Ω–µ–º–µ—Å–µ —Ç–∞–∫—Å–∏–º–µ–Ω –∂–µ—Ç—É–≥–µ –±–æ–ª–∞–¥—ã. –ö—ñ—Ä—É: 2000-5000‚Ç∏",
        "–ú–µ–¥–µ—É –∫–µ—Ä–µ–º–µ—Ç –æ—Ä—ã–Ω! “ö—ã—Å—Ç–∞ –∫–æ–Ω—å–∫–∏ —Ç–µ–±—É–≥–µ, –∂–∞–∑–¥–∞ —Å–µ—Ä—É–µ–Ω–¥–µ—É–≥–µ –∂–∞—Ä–∞–π–¥—ã. –ñ“±–º—ã—Å —É–∞“õ—ã—Ç—ã: 09:00-21:00",
        "–ú–µ–¥–µ–æ - –≤—ã—Å–æ–∫–æ–≥–æ—Ä–Ω—ã–π –∫–∞—Ç–æ–∫ –º–∏—Ä–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è! –ß–∏—Å—Ç–µ–π—à–∏–π –≤–æ–∑–¥—É—Ö –∏ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–µ –≤–∏–¥—ã. –†–∞–±–æ—Ç–∞–µ—Ç 09:00-21:00"
    ],
    
    // –ö”©–∫—Ç”©–±–µ –∂–∞–π—ã–Ω–¥–∞
    koktobe: [
        "<i class='fa-solid fa-tower-observation'></i> –ö”©–∫—Ç”©–±–µ - –ê–ª–º–∞—Ç—ã–Ω—ã“£ —Å–∏–º–≤–æ–ª—ã! –ê—Å–ø–∞–ª—ã –∂–æ–ª –∞—Ä“õ—ã–ª—ã –∫”©—Ç–µ—Ä—ñ–ª–µ—Å—ñ–∑, –∂–æ“ì–∞—Ä—ã–¥–∞ –∫”©—Ä—ñ–Ω—ñ—Å –∞–ª–∞“£—ã, –ø–∞—Ä–∫—ñ –∂”ô–Ω–µ –º–µ–π—Ä–∞–º—Ö–∞–Ω–∞ –±–∞—Ä. –¢–∞“£–µ—Ä—Ç–µ“£ 10:00-–¥–µ–Ω –∫–µ—à–∫–µ 23:00-–≥–µ –¥–µ–π—ñ–Ω –∂“±–º—ã—Å —ñ—Å—Ç–µ–π–¥—ñ.",
        "–ö”©–∫—Ç”©–±–µ–Ω—ñ“£ –∞—Å–ø–∞–ª—ã –∂–æ–ª—ã - –µ—Ä–µ–∫—à–µ —Ç”ô–∂—ñ—Ä–∏–±–µ! <i class='fa-solid fa-cable-car'></i> –ñ–æ“ì–∞—Ä—ã–¥–∞ “õ–∞–ª–∞–Ω—ã“£ —Ç–∞–º–∞—à–∞ –∫”©—Ä—ñ–Ω—ñ—Å—ñ –∞—à—ã–ª–∞–¥—ã. –ö—ñ—Ä—É “õ“±–Ω—ã: 1000-3000‚Ç∏",
        "–ö–æ–∫-–¢–æ–±–µ - —Å–∏–º–≤–æ–ª –≥–æ—Ä–æ–¥–∞! –ö–∞–Ω–∞—Ç–Ω–∞—è –¥–æ—Ä–æ–≥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç 10:00-23:00. –ù–∞–≤–µ—Ä—Ö—É —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã –∏ —Å–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞!"
    ],
    
    // –ë–ê–û –∂–∞–π—ã–Ω–¥–∞
    bao: [
        "<i class='fa-solid fa-water'></i> –ë–ê–û (“Æ–ª–∫–µ–Ω –ê–ª–º–∞—Ç—ã –∫”©–ª—ñ) - —Ç–∞—É–ª–∞—Ä–¥–∞“ì—ã –∫”©–≥—ñ–ª–¥—ñ—Ä –∞—Å—ã–ª —Ç–∞—Å! –¢–∞–±–∏“ì–∞—Ç —Å“Ø–π–≥—ñ—à—Ç–µ—Ä—ñ–Ω–µ —Ç–∞–º–∞—à–∞. –¢–∞–∫—Å–∏–º–µ–Ω –Ω–µ–º–µ—Å–µ –∂–µ–∫–µ –∫”©–ª—ñ–∫–ø–µ–Ω –±–∞—Ä—É“ì–∞ –±–æ–ª–∞–¥—ã.",
        "“Æ–ª–∫–µ–Ω –ê–ª–º–∞—Ç—ã –∫”©–ª—ñ - –Ω–∞“õ—Ç—ã –∂“±–º–∞“õ“õ–∞ —Å–∞—è—Ö–∞—Ç! <i class='fa-solid fa-mountain'></i> –¢–µ–≥—ñ–Ω, –±—ñ—Ä–∞“õ —Ç–∞–∫—Å–∏–º–µ–Ω –±–∞—Ä—É –∫–µ—Ä–µ–∫. –ñ–∞–∑–¥–∞ –∂”ô–Ω–µ –∫“Ø–∑–¥–µ –µ“£ ”ô–¥–µ–º—ñ!",
        "–ë–ê–û - –≥–æ–ª—É–±–∞—è –∂–µ–º—á—É–∂–∏–Ω–∞ –≥–æ—Ä! –ë–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–æ –Ω—É–∂–Ω–æ —Ç–∞–∫—Å–∏. –õ—É—á—à–µ –ø–æ—Å–µ—â–∞—Ç—å –ª–µ—Ç–æ–º –∏–ª–∏ –æ—Å–µ–Ω—å—é."
    ],
    
    // –®—ã–º–±“±–ª–∞“õ –∂–∞–π—ã–Ω–¥–∞
    shymbulak: [
        "<i class='fa-solid fa-person-skiing'></i> –®—ã–º–±“±–ª–∞“õ - —Ç–∞—É-—à–∞“£“ì—ã –∫—É—Ä–æ—Ä—Ç—ã! “ö—ã—Å—Ç–∞ —à–∞“£“ì—ã —Ç–µ–±—É, –∂–∞–∑–¥–∞ —Å–µ—Ä—É–µ–Ω–¥–µ—É. –ì–æ–Ω–¥–æ–ª –∞—Ä“õ—ã–ª—ã –∫”©—Ç–µ—Ä—ñ–ª–µ—Å—ñ–∑. “ö“±–Ω—ã: 5000-15000‚Ç∏",
        "–®—ã–º–±—É–ª–∞–∫ - –ª—É—á—à–∏–π –≥–æ—Ä–Ω–æ–ª—ã–∂–Ω—ã–π –∫—É—Ä–æ—Ä—Ç! –†–∞–±–æ—Ç–∞–µ—Ç 09:00-17:00. –ó–∏–º–æ–π –∫–∞—Ç–∞–Ω–∏–µ, –ª–µ—Ç–æ–º –ø–µ—à–∏–µ –ø—Ä–æ–≥—É–ª–∫–∏.",
        "–®—ã–º–±“±–ª–∞“õ—Ç–∞ –ú–µ–¥–µ—É–¥–µ–Ω –∂–æ“ì–∞—Ä—ã –∫”©—Ç–µ—Ä—ñ–ª–µ –∞–ª–∞—Å—ã–∑! “ö—ã—Å—ã “ì–∞–∂–∞–ø, –∂–∞–∑—ã –¥–∞ ”ô–¥–µ–º—ñ!"
    ],
    
    // –ü–∞—Ä–∫ –∂–∞–π—ã–Ω–¥–∞
    park: [
        "<i class='fa-solid fa-tree'></i> –ë—ñ—Ä—ñ–Ω—à—ñ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –ø–∞—Ä–∫—ñ - “õ–∞–ª–∞–Ω—ã“£ –æ—Ä—Ç–∞–ª—ã“ì—ã–Ω–¥–∞“ì—ã “Ø–ª–∫–µ–Ω –ø–∞—Ä–∫. –¢–µ–≥—ñ–Ω, –º–µ—Ç—Ä–æ –ê–±–∞–π —Å—Ç–∞–Ω—Ü–∏—è—Å—ã–Ω–∞ –∂–∞“õ—ã–Ω. –ö”©–∫—Ç–µ–º –º–µ–Ω –∂–∞–∑–¥–∞ —Ç–∞–º–∞—à–∞!",
        "–ü–∞—Ä–∫ –ü–µ—Ä–≤–æ–≥–æ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –ø—Ä–æ–≥—É–ª–æ–∫! –ë–µ—Å–ø–ª–∞—Ç–Ω–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç 06:00-23:00. –í–æ–∑–ª–µ –º–µ—Ç—Ä–æ –ê–±–∞–π.",
        "–ü–∞—Ä–∫—Ç–µ —Å–µ—Ä—É–µ–Ω–¥–µ–ø, –¥–µ–º–∞–ª—É“ì–∞ –±–æ–ª–∞–¥—ã. –ë–∞–ª–∞–ª–∞—Ä“ì–∞ –¥–∞ “õ—ã–∑—ã“õ—Ç—ã! <i class='fa-solid fa-child-reaching'></i>"
    ],
    
    // –°–∞—É–¥–∞ –æ—Ä—Ç–∞–ª—ã“õ—Ç–∞—Ä—ã
    mall: [
        "<i class='fa-solid fa-bag-shopping'></i> Esentai Mall - “õ–∞–ª–∞–Ω—ã“£ –µ“£ “Ø–ª–∫–µ–Ω —Å–∞—É–¥–∞ –æ—Ä—Ç–∞–ª—ã“ì—ã. –°–∞—É–¥–∞, —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä. 10:00-22:00 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ –∂“±–º—ã—Å —ñ—Å—Ç–µ–π–¥—ñ.",
        "–ï—Å–µ–Ω—Ç–∞–π –ú–æ–ª–ª “Ø—à—ñ–Ω –±–∞—Ä–ª—ã“õ “õ–æ“ì–∞–º–¥—ã“õ –∫”©–ª—ñ–∫ –∂–∞—Ä–∞–π–¥—ã. –û–Ω–¥–∞ –±–∞—Ä–ª—ã“õ –±—Ä–µ–Ω–¥ –¥“Ø–∫–µ–Ω–¥–µ—Ä—ñ –±–∞—Ä!",
        "–í Esentai Mall –µ—Å—Ç—å –≤—Å—ë - –æ—Ç –±—É—Ç–∏–∫–æ–≤ –¥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤! –†–∞–±–æ—Ç–∞–µ—Ç 10:00-22:00"
    ],
    
    // –ñ–∞–ª–ø—ã –∫–µ“£–µ—Å—Ç–µ—Ä
    recommendations: [
        "<i class='fa-solid fa-star'></i> –ú–µ–Ω –ö”©–∫—Ç”©–±–µ–Ω—ñ “±—Å—ã–Ω–∞–º—ã–Ω! –û–Ω–¥–∞ “õ–∞–ª–∞–Ω—ã“£ –∫–µ—Ä–µ–º–µ—Ç –∫”©—Ä—ñ–Ω—ñ—Å—ñ –±–∞—Ä –∂”ô–Ω–µ –∫–µ—à–∫—ñ—Å—ñ–Ω –µ—Ä–µ–∫—à–µ ”ô–¥–µ–º—ñ.",
        "–ï–≥–µ—Ä —Ç–∞–±–∏“ì–∞—Ç—Ç—ã –∂–∞“õ—Å—ã –∫”©—Ä—Å–µ“£—ñ–∑ - –ë–ê–û “õ–∞–∂–µ—Ç! –ö”©–≥—ñ–ª–¥—ñ—Ä –∫”©–ª —Ç–∞“£“ì–∞–∂–∞–π—ã–ø.",
        "–†–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–∞—á–∞—Ç—å —Å –ö–æ–∫-–¢–æ–±–µ! –¢–∞–º –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–µ—Å—å –≤–µ—á–µ—Ä.",
        "“ö—ã—Å –±–æ–ª—Å–∞ - –ú–µ–¥–µ—É –º–µ–Ω –®—ã–º–±“±–ª–∞“õ! –ñ–∞–∑ –±–æ–ª—Å–∞ - –ë–ê–û –º–µ–Ω –ø–∞—Ä–∫—Ç–µ—Ä!",
        "–°–ø–æ—Ä—Ç —Å“Ø–π—Å–µ“£—ñ–∑ - –ú–µ–¥–µ—É –º–µ–Ω –®—ã–º–±“±–ª–∞“õ. –î–µ–º–∞–ª“ì—ã“£—ã–∑ –∫–µ–ª—Å–µ - –ö”©–∫—Ç”©–±–µ –∂”ô–Ω–µ –ø–∞—Ä–∫—Ç–µ—Ä."
    ],
    
    // –ê—É–∞ —Ä–∞–π—ã –∂–∞–π—ã–Ω–¥–∞
    weather: [
        "<i class='fa-solid fa-cloud-sun'></i> –ê—É–∞ —Ä–∞–π—ã–Ω —Ç–µ–∫—Å–µ—Ä—ñ–ø –∂–∞—Ç—ã—Ä–º—ã–Ω...",
        "“ö–∞–∑—ñ—Ä–≥—ñ –∞—É–∞ —Ä–∞–π—ã–Ω –æ—Å—ã –±–µ—Ç—Ç—ñ“£ —Ç”©–º–µ–Ω–≥—ñ –∂–∞“ì—ã–Ω–∞–Ω –∫”©—Ä–µ –∞–ª–∞—Å—ã–∑!",
        "–ü—Ä–æ–≤–µ—Ä—è—é –ø–æ–≥–æ–¥—É –¥–ª—è –≤–∞—Å..."
    ],
    
    // “ö–∞–ª–∞–π –±–∞—Ä—É —Ç—É—Ä–∞–ª—ã
    howToGet: [
        "<i class='fa-solid fa-bus'></i> “ö–æ“ì–∞–º–¥—ã“õ –∫”©–ª—ñ–∫–ø–µ–Ω –Ω–µ–º–µ—Å–µ —Ç–∞–∫—Å–∏–º–µ–Ω –∂–µ—Ç—É–≥–µ –±–æ–ª–∞–¥—ã. “ö–∞–π–¥–∞ –±–∞—Ä“ì—ã“£—ã–∑ –∫–µ–ª–µ–¥—ñ?",
        "–°—ñ–∑–≥–µ “õ–∞–π –æ—Ä—ã–Ω“ì–∞ –∂–æ–ª –∫–µ—Ä–µ–∫? –ú–µ–¥–µ—É, –ö”©–∫—Ç”©–±–µ –Ω–µ–º–µ—Å–µ –±–∞—Å“õ–∞ –∂–µ—Ä?",
        "–°–∫–∞–∂–∏—Ç–µ –∫—É–¥–∞ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø–∞—Å—Ç—å, –∏ —è –ø–æ–¥—Å–∫–∞–∂—É –º–∞—Ä—à—Ä—É—Ç!"
    ],
    
    // –¢“Ø—Å—ñ–Ω–±–µ–≥–µ–Ω —Å“±—Ä–∞“õ—Ç–∞—Ä
    unknown: [
        "ü§î –ö–µ—à—ñ—Ä—ñ“£—ñ–∑, —Ç“Ø—Å—ñ–Ω–±–µ–¥—ñ–º. –°—ñ–∑ –ú–µ–¥–µ—É, –ö”©–∫—Ç”©–±–µ, –ë–ê–û –Ω–µ–º–µ—Å–µ –±–∞—Å“õ–∞ –æ—Ä—ã–Ω —Ç—É—Ä–∞–ª—ã —Å“±—Ä–∞–π –∞–ª–∞—Å—ã–∑.",
        "–ú–µ–Ω –ê–ª–º–∞—Ç—ã–Ω—ã“£ –¥–µ–º–∞–ª—ã—Å –æ—Ä—ã–Ω–¥–∞—Ä—ã —Ç—É—Ä–∞–ª—ã –∞–π—Ç–∞ –∞–ª–∞–º—ã–Ω. –ù–µ –±—ñ–ª–≥—ñ“£—ñ–∑ –∫–µ–ª–µ–¥—ñ?",
        "–ò–∑–≤–∏–Ω–∏—Ç–µ, –Ω–µ –ø–æ–Ω—è–ª. –°–ø—Ä–æ—Å–∏—Ç–µ –æ –ú–µ–¥–µ–æ, –ö–æ–∫-–¢–æ–±–µ, –ë–ê–û –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö!",
        "–ú–µ–Ω—ñ —Å“±—Ä–∞—Å—Ç—ã—Ä—ã“£—ã–∑: '“ö–∞–π–¥–∞ –±–∞—Ä—É“ì–∞ –±–æ–ª–∞–¥—ã?', '–ú–µ–¥–µ—É–≥–µ “õ–∞–ª–∞–π –±–∞—Ä–∞–º—ã–Ω?' –Ω–µ–º–µ—Å–µ '–∞—É–∞ —Ä–∞–π—ã “õ–∞–Ω–¥–∞–π?'"
    ],
    
    // –†–∞“õ–º–µ—Ç
    thanks: [
        "“ö–æ—à –±–æ–ª—ã“£—ã–∑! <i class='fa-solid fa-face-smile'></i> –ê–ª–º–∞—Ç—ã–¥–∞ –∂–∞“õ—Å—ã —Å–µ—Ä—É–µ–Ω–¥–µ“£—ñ–∑!",
        "–ú—ñ–Ω–¥–µ—Ç—Ç—ñ —Ç“Ø—Ä–¥–µ! –°—ñ–∑–≥–µ —Å”ô—Ç—Ç—ñ–ª—ñ–∫! <i class='fa-solid fa-star'></i>",
        "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –•–æ—Ä–æ—à–µ–≥–æ –æ—Ç–¥—ã—Ö–∞ –≤ –ê–ª–º–∞—Ç—ã! <i class='fa-solid fa-heart'></i>"
    ]
};

/**
 * –ß–∞—Ç–±–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è—Å—ã
 */
function initChatbot() {
    const sendBtn = document.getElementById('send-btn');
    const chatInput = document.getElementById('chat-input');
    
    if (!sendBtn || !chatInput) {
        console.error('Chat elements not found!');
        return;
    }

    // –ñ—ñ–±–µ—Ä—É –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω–∞ –±–∞—Å—É
    sendBtn.addEventListener('click', handleSendMessage);
    
    // Enter –±–∞—Ç—ã—Ä–º–∞—Å—ã
    chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            handleSendMessage();
        }
    });

    console.log('‚úÖ –ß–∞—Ç–±–æ—Ç “õ–æ—Å—ã–ª–¥—ã');
}

/**
 * –•–∞–±–∞—Ä–ª–∞–º–∞ –∂—ñ–±–µ—Ä—É
 */
function handleSendMessage() {
    const chatInput = document.getElementById('chat-input');
    const userMessage = chatInput.value.trim();
    
    if (!userMessage) return;
    
    // –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã —Ö–∞–±–∞—Ä–ª–∞–º–∞—Å—ã–Ω –∫”©—Ä—Å–µ—Ç—É
    addMessage(userMessage, 'user');
    
    // Input —Ç–∞–∑–∞–ª–∞—É
    chatInput.value = '';
    
    // –ë–æ—Ç –∂–∞—É–∞–±—ã–Ω –∞–ª—É (–∫—ñ—à–∫–µ–Ω–µ –∫—ñ–¥—ñ—Ä—ñ—Å–ø–µ–Ω)
    setTimeout(() => {
        const botResponse = getBotResponse(userMessage);
        addMessage(botResponse, 'bot');
        
        // –ï–≥–µ—Ä –∞—É–∞ —Ä–∞–π—ã —Å“±—Ä–∞–ª—Å–∞
        if (userMessage.toLowerCase().includes('–∞—É–∞') || 
            userMessage.toLowerCase().includes('–ø–æ–≥–æ–¥') ||
            userMessage.toLowerCase().includes('weather')) {
            loadWeatherInfo();
        }
    }, 500);
}

/**
 * –•–∞–±–∞—Ä–ª–∞–º–∞–Ω—ã “õ–æ—Å—É
 */
function addMessage(text, sender) {
    const chatMessages = document.getElementById('chat-messages');
    
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${sender}-message`;
    
    const avatar = sender === 'bot' ? '<i class="fa-solid fa-robot"></i>' : '<i class="fa-solid fa-user"></i>';
    
    messageDiv.innerHTML = `
        <div class="message-avatar">${avatar}</div>
        <div class="message-bubble">${text}</div>
    `;
    
    chatMessages.appendChild(messageDiv);
    
    // –ê–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç“Ø—Ä–¥–µ —Ç”©–º–µ–Ω–≥–µ –∂—ã–ª–∂—ã—Ç—É
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

/**
 * –ë–æ—Ç –∂–∞—É–∞–±—ã–Ω –∞–ª—É (AI –ª–æ–≥–∏–∫–∞—Å—ã)
 */
function getBotResponse(userMessage) {
    const message = userMessage.toLowerCase();
    
    // –°”ô–ª–µ–º–¥–µ—Å—É
    if (message.match(/—Å”ô–ª–µ–º|—Å–∞–ª–µ–º|–ø—Ä–∏–≤–µ—Ç|hello|hi|“õ–∞–π—ã—Ä–ª—ã/)) {
        return getRandomResponse(chatbotResponses.greeting);
    }
    
    // –ú–µ–¥–µ—É
    if (message.includes('–º–µ–¥–µ—É') || message.includes('–º–µ–¥–µ–æ') || message.includes('medeu')) {
        return getRandomResponse(chatbotResponses.medeu);
    }
    
    // –ö”©–∫—Ç”©–±–µ
    if (message.includes('–∫”©–∫') || message.includes('–∫–æ–∫') || message.includes('–∫–æ–∫—Ç–æ–±–µ') || message.includes('koktobe')) {
        return getRandomResponse(chatbotResponses.koktobe);
    }
    
    // –ë–ê–û
    if (message.includes('–±–∞–æ') || message.includes('–∫”©–ª') || message.includes('–æ–∑–µ—Ä–æ') || message.includes('lake')) {
        return getRandomResponse(chatbotResponses.bao);
    }
    
    // –®—ã–º–±“±–ª–∞“õ
    if (message.includes('—à—ã–º–±') || message.includes('—à–∏–º–±') || message.includes('shymbulak')) {
        return getRandomResponse(chatbotResponses.shymbulak);
    }
    
    // –ü–∞—Ä–∫
    if (message.includes('–ø–∞—Ä–∫') || message.includes('park')) {
        return getRandomResponse(chatbotResponses.park);
    }
    
    // –°–∞—É–¥–∞ –æ—Ä—Ç–∞–ª—ã“ì—ã
    if (message.includes('–º–æ–ª–ª') || message.includes('mall') || message.includes('–¥“Ø–∫–µ–Ω') || message.includes('–º–∞–≥–∞–∑–∏–Ω') || message.includes('esentai')) {
        return getRandomResponse(chatbotResponses.mall);
    }
    
    // –ö–µ“£–µ—Å —Å“±—Ä–∞—É
    if (message.match(/“õ–∞–π–¥–∞|–∫—É–¥–∞|where|–∫–µ“£–µ—Å|—Å–æ–≤–µ—Ç|“±—Å—ã–Ω|—Ä–µ–∫–æ–º–µ–Ω–¥/)) {
        return getRandomResponse(chatbotResponses.recommendations);
    }
    
    // –ê—É–∞ —Ä–∞–π—ã
    if (message.includes('–∞—É–∞') || message.includes('–ø–æ–≥–æ–¥') || message.includes('weather')) {
        return getRandomResponse(chatbotResponses.weather);
    }
    
    // “ö–∞–ª–∞–π –±–∞—Ä—É
    if (message.match(/“õ–∞–ª–∞–π|–∫–∞–∫|how|–∂–æ–ª|–¥–æ—Ä–æ–≥|–º–∞—Ä—à—Ä—É—Ç|–±–∞—Ä/)) {
        return getRandomResponse(chatbotResponses.howToGet);
    }
    
    // –†–∞“õ–º–µ—Ç
    if (message.match(/—Ä–∞“õ–º–µ—Ç|—Ä–∞—Ö–º–µ—Ç|—Å–ø–∞—Å–∏–±–æ|thanks|thank/)) {
        return getRandomResponse(chatbotResponses.thanks);
    }
    
    // –¢“Ø—Å—ñ–Ω–±–µ–≥–µ–Ω –∂–∞“ì–¥–∞–π–¥–∞
    return getRandomResponse(chatbotResponses.unknown);
}

/**
 * –ö–µ–∑–¥–µ–π—Å–æ“õ –∂–∞—É–∞–ø –∞–ª—É
 */
function getRandomResponse(responses) {
    return responses[Math.floor(Math.random() * responses.length)];
}

/**
 * –ß–∞—Ç–±–æ—Ç—Ç–∞–Ω —Å“±—Ä–∞—É (–±–∞—Å“õ–∞ –º–æ–¥—É–ª—å–¥–µ—Ä–¥–µ–Ω)
 */
function askChatbot(placeName) {
    // –ú–æ–¥–∞–ª–¥—ã —Ç–µ—Ä–µ–∑–µ–Ω—ñ –∂–∞–±—É
    if (typeof closeModal === 'function') {
        closeModal();
    }
    
    // –ß–∞—Ç–±–æ—Ç –±”©–ª—ñ–º—ñ–Ω–µ –∂—ã–ª–∂—É
    scrollToSection('chatbot');
    
    // 500–º—Å –∫—ñ–¥—ñ—Ä—ñ—Å
    setTimeout(() => {
        const chatInput = document.getElementById('chat-input');
        chatInput.value = `${placeName} —Ç—É—Ä–∞–ª—ã –∞–π—Ç—ã–ø –±–µ—Ä`;
        chatInput.focus();
    }, 500);
}

/**
 * –ö–∞—Ä—Ç–∞–Ω—ã –∫”©—Ä—Å–µ—Ç—É (–±–∞—Å“õ–∞ –º–æ–¥—É–ª—å–¥–µ—Ä–¥–µ–Ω —à–∞“õ—ã—Ä—ã–ª–∞–¥—ã)
 */
function showOnMap(lat, lng, placeName) {
    // –ú–æ–¥–∞–ª–¥—ã —Ç–µ—Ä–µ–∑–µ–Ω—ñ –∂–∞–±—É
    if (typeof closeModal === 'function') {
        closeModal();
    }
    
    scrollToSection('map');
    
    setTimeout(() => {
        if (typeof focusOnPlace === 'function') {
            focusOnPlace(lat, lng, placeName);
        }
    }, 500);
}

/**
 * –ê—É–∞ —Ä–∞–π—ã–Ω –∂“Ø–∫—Ç–µ—É
 */
function loadWeatherInfo() {
    if (typeof getWeatherData === 'function') {
        getWeatherData();
    }
}

// –ë–µ—Ç –∂“Ø–∫—Ç–µ–ª–≥–µ–Ω–¥–µ —á–∞—Ç–±–æ—Ç—Ç—ã —ñ—Å–∫–µ “õ–æ—Å—É
document.addEventListener('DOMContentLoaded', initChatbot);

// Export (–±–∞—Å“õ–∞ –º–æ–¥—É–ª—å–¥–µ—Ä “Ø—à—ñ–Ω)
if (typeof module !== 'undefined' && module.exports) {
    module.exports = {
        initChatbot,
        addMessage,
        getBotResponse,
        askChatbot
    };
}
